
PLAY [aio] *********************************************************************

TASK [Gathering Facts] *********************************************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Check if certificates already exists] *****
ok: [wazuh-server -> localhost]

TASK [../roles/wazuh/wazuh-indexer : Local action | Create local temporary directory for certificates generation] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Check that the generation tool exists] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Download certificates generation tool] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Prepare the certificates generation template file] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Generate the node & admin certificates in local] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Add Wazuh indexer repo] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Amazon extras in Amazon Linux 2] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Configure vm.max_map_count] ***************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Update vm.max_map_count] ******************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Install Indexer dependencies] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer] ********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Update cache] *****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer dependencies] *******
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Add apt repository signing key] ***********
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Import Wazuh repository GPG key] **********
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Set permissions for Wazuh repository GPG key] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Add Wazuh indexer repository] *************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer] ********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove performance analyzer plugin from Wazuh indexer] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove Opensearch configuration file] *****
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Copy Opensearch Configuration File] *******
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_tasks] ****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Configure Wazuh indexer JVM memmory.] *****
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Ensure extra time for Wazuh indexer to start on reboots] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Index files to remove] ********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove Index Files] ***********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Ensure Wazuh indexer started and enabled] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Wait for Wazuh indexer API] ***************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Wait for Wazuh indexer API (Private IP)] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Remove Wazuh indexer repository (and clean up left-over metadata)] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Reload systemd configuration] *************
skipping: [wazuh-server]

PLAY [aio] *********************************************************************

TASK [Gathering Facts] *********************************************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_vars] *****************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Check if certificates already exists] *****
ok: [wazuh-server -> localhost]

TASK [../roles/wazuh/wazuh-indexer : Local action | Create local temporary directory for certificates generation] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Check that the generation tool exists] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Download certificates generation tool] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Prepare the certificates generation template file] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Local action | Generate the node & admin certificates in local] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Add Wazuh indexer repo] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Amazon extras in Amazon Linux 2] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Configure vm.max_map_count] ***************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Update vm.max_map_count] ******************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Install Indexer dependencies] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer] ********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Update cache] *****************************
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer dependencies] *******
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Add apt repository signing key] ***********
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Import Wazuh repository GPG key] **********
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Set permissions for Wazuh repository GPG key] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Add Wazuh indexer repository] *************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Install Wazuh indexer] ********************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove performance analyzer plugin from Wazuh indexer] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove Opensearch configuration file] *****
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Copy Opensearch Configuration File] *******
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : include_tasks] ****************************
included: /home/huy/Documents/IaC-project/ansible/wazuh-ansible-4.14.1/roles/wazuh/wazuh-indexer/tasks/security_actions.yml for wazuh-server

TASK [../roles/wazuh/wazuh-indexer : Configure IP (Private address)] ***********
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Configure IP (Public address)] ************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Ensure Indexer certificates directory permissions.] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Copy the node & admin certificates to Wazuh indexer cluster] ***
ok: [wazuh-server] => (item=root-ca.pem)
ok: [wazuh-server] => (item=node-1-key.pem)
ok: [wazuh-server] => (item=node-1.pem)
ok: [wazuh-server] => (item=admin-key.pem)
ok: [wazuh-server] => (item=admin.pem)

TASK [../roles/wazuh/wazuh-indexer : Restart Wazuh indexer with security configuration] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Copy the Opensearch security internal users template] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Hashing the custom admin password] ********
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Set the Admin user password] **************
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Hash the kibanaserver role/user pasword] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Set the kibanaserver user password] *******
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Initialize the Opensearch security index in Wazuh indexer] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Create custom user] ***********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Configure Wazuh indexer JVM memmory.] *****
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Ensure extra time for Wazuh indexer to start on reboots] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Index files to remove] ********************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Remove Index Files] ***********************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Ensure Wazuh indexer started and enabled] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Wait for Wazuh indexer API] ***************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Wait for Wazuh indexer API (Private IP)] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : RedHat/CentOS/Fedora | Remove Wazuh indexer repository (and clean up left-over metadata)] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-indexer : Reload systemd configuration] *************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : include_vars] ***************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : include_vars] ***************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : include_vars] ***************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : include_vars] ***************************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : RedHat/CentOS/Fedora | Add Wazuh dashboard repo] ***
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Install Wazuh dashboard] ****************
skipping: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : include_vars] ***************************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Download apt repository signing key] ****
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Debian/Ubuntu | Install gnupg] **********
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Import Wazuh repository GPG key] ********
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Set permissions for Wazuh repository GPG key] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Debian systems | Add Wazuh dashboard repo] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Install Wazuh dashboard] ****************
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Remove Dashboard configuration file] ****
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Ensure Dashboard certificates directory permissions.] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Copy the certificates from local to the Wazuh dashboard instance] ***
changed: [wazuh-server] => (item=root-ca.pem)
changed: [wazuh-server] => (item=node-1-key.pem)
changed: [wazuh-server] => (item=node-1.pem)

TASK [../roles/wazuh/wazuh-dashboard : Copy Configuration File] ****************
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Ensuring Wazuh dashboard directory owner] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Wait for Wazuh-Indexer port] ************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Select correct API protocol] ************
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Attempting to delete legacy Wazuh index if exists] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Create Wazuh Plugin config directory] ***
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Configure Wazuh Dashboard Plugin] *******
ok: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Configure opensearch.password in opensearch_dashboards.keystore] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Ensure Wazuh dashboard started and enabled] ***
changed: [wazuh-server]

TASK [../roles/wazuh/wazuh-dashboard : Remove Wazuh dashboard repository (and clean up left-over metadata)] ***
skipping: [wazuh-server]

RUNNING HANDLER [../roles/wazuh/wazuh-indexer : restart wazuh-indexer] *********
changed: [wazuh-server]

RUNNING HANDLER [../roles/wazuh/wazuh-dashboard : restart wazuh-dashboard] *****
changed: [wazuh-server]

PLAY RECAP *********************************************************************
wazuh-server               : ok=58   changed=22   unreachable=0    failed=0    skipped=56   rescued=0    ignored=0   

